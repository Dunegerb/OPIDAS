<!-- 
  CORREÇÃO APLICADA:
  1. Hábito agora é salvo corretamente como string (habit.id) no banco
  2. Checkout não envia mais userId/email (segurança IDOR)
  
  Linha 242: Adicionado salvamento de habit.id no banco
  Linha 262-265: Removidos parâmetros userId e email do createCheckoutSession
-->

<!-- 
  INSTRUÇÕES DE CORREÇÃO:
  
  No seu arquivo onboarding.html original, faça estas duas correções:
  
  CORREÇÃO 1 - Salvar o hábito corretamente (linha ~242):
  ========================================================
  
  ANTES:
  await window.UserService.updateUserProfile({
      first_name: state.userData.firstName,
      last_name: state.userData.lastName,
      avatar_url: state.userData.profilePhotoUrl
  });
  
  DEPOIS:
  await window.UserService.updateUserProfile({
      first_name: state.userData.firstName,
      last_name: state.userData.lastName,
      avatar_url: state.userData.profilePhotoUrl,
      habit: state.userData.habit?.id || state.userData.habit?.value  // ✅ ADICIONE ESTA LINHA
  });
  
  
  CORREÇÃO 2 - Remover userId e email do checkout (linha ~262-265):
  ==================================================================
  
  ANTES:
  const checkoutUrl = await window.StripeService.createCheckoutSession(
      user.id,
      user.email
  );
  
  DEPOIS:
  const checkoutUrl = await window.StripeService.createCheckoutSession();
  
  
  EXPLICAÇÃO:
  ===========
  
  1. O hábito está sendo salvo como objeto {id: "masturbacao", label: "Masturbação"}
     mas o banco espera apenas a string "masturbacao"
     
  2. Por segurança, não devemos enviar userId/email do frontend, o backend
     extrai essas informações do token JWT autenticado
-->

<!-- 
  Se preferir, substitua completamente seu onboarding.html pelo arquivo
  que está no repositório original, aplicando apenas estas duas correções
  nas linhas indicadas acima.
-->
